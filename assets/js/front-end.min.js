jQuery(document).ready(function($){$(".ask-me-anything-button").click(function(e){e.preventDefault();var targetID=$(this).data("target");AskMeAnythingLaunchModal(targetID)});$(document).mouseup(function(e){var container=$(".ask-me-anything-modal-inner");if(!container.is(e.target)&&container.has(e.target).length===0){AskMeAnythingCloseModal("#ask-me-anything")}});document.addEventListener("keydown",function(ev){var keyCode=ev.keyCode||ev.which;if(keyCode===27){AskMeAnythingCloseModal("#ask-me-anything")}});function AskMeAnythingLaunchModal(targetID){if(targetID==""||typeof targetID==="undefined"){return false}$("body").append('<div id="ask-me-anything-backdrop"></div>');$("#ask-me-anything-backdrop").addClass("ama-in");$(targetID).show().addClass("ama-in");AskMeAnythingLoadFormTemplate();if(ASK_ME_ANYTHING.display_questions==true){AskMeAnythingGetQuestions(1)}}function AskMeAnythingCloseModal(targetID){if(targetID==""||typeof targetID==="undefined"){return false}$(targetID).hide();$("#ask-me-anything-backdrop").remove()}function AskMeAnythingLoadFormTemplate(message){var amaFormTemplate=wp.template("ama-submit-form");var amaSubmitData={message:typeof message!=="undefined"?message:"",form_title_text:ASK_ME_ANYTHING.form_title_text,form_description:ASK_ME_ANYTHING.form_description,form_require_name:ASK_ME_ANYTHING.form_require_name,form_require_email:ASK_ME_ANYTHING.form_require_email,form_question_field_name:ASK_ME_ANYTHING.form_question_field_name};$(".ask-me-anything-submit-question").empty().append(amaFormTemplate(amaSubmitData));$(".ask-me-anything-submit-question-form").submit(function(e){e.preventDefault();var submitForm=$(this);submitForm.find("button").attr("disabled",true);submitForm.append('<i class="fa fa-spinner fa-spin"></i>');var formData=$(this).serializeArray();var data={action:"ask_me_anything_submit_question",formData:formData,nonce:ASK_ME_ANYTHING.nonce};$.post(ASK_ME_ANYTHING.ajaxurl,data,function(response){console.log(response);var responseClass="ama-error";if(response.success==true){responseClass="ama-success"}var finalMessage='<div class="'+responseClass+'">'+response.data+"</div>";if(response.success==true){AskMeAnythingLoadFormTemplate(finalMessage)}else{submitForm.find("button").attr("disabled",false);submitForm.find(".fa-spin, .ama-error").remove();submitForm.prepend(finalMessage)}})})}function AskMeAnythingGetQuestions(page){var amaQuestionTemplate=wp.template("ama-question");var questionsList=$(".ask-me-anything-questions-list");questionsList.empty().append('<div style="text-align: center; padding: 1em;"><i class="fa fa-spinner fa-spin fa-3x"></i></div>');var data={action:"ask_me_anything_get_questions",page_number:page,nonce:ASK_ME_ANYTHING.nonce};$.post(ASK_ME_ANYTHING.ajaxurl,data,function(response){if(response.success==true){questionsList.empty().append(amaQuestionTemplate({questions:response.data}));AskMeAnythingRenderQuestion()}else{console.log(response)}})}function AskMeAnythingRenderQuestion(){$(".ama-question-item").click(function(e){e.preventDefault();var questionID=$(this).data("postid");$(".ama-question-item").each(function(){$(this).removeClass("ama-active");if($(this).data("postid")==questionID){$(this).addClass("ama-active")}});var questionArea=$(".ask-me-anything-submit-question");questionArea.empty().append('<div style="text-align: center;"><i class="fa fa-spinner fa-spin fa-3x"></i></div>');var data={action:"ask_me_anything_load_question",question_id:questionID,nonce:ASK_ME_ANYTHING.nonce};$.post(ASK_ME_ANYTHING.ajaxurl,data,function(response){if(response.success==true){var amaQuestionTemplate=wp.template("ama-single-question");questionArea.empty().append(amaQuestionTemplate(response.data));AskMeAnythingInitializeVoting();AskMeAnythingSubmitComment();$(".ama-load-question-form").click(function(e){e.preventDefault();AskMeAnythingLoadFormTemplate()})}else{console.log(response)}})})}function AskMeAnythingInitializeVoting(){$(".ama-up-vote").click(function(e){console.log("clicked")})}function AskMeAnythingSubmitComment(){}});